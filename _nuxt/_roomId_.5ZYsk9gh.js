var K=Object.defineProperty;var L=(l,_,a)=>_ in l?K(l,_,{enumerable:!0,configurable:!0,writable:!0,value:a}):l[_]=a;var k=(l,_,a)=>(L(l,typeof _!="symbol"?_+"":_,a),a);import{d as b,H as z,i as n,v as m,F as f,B as t,A as e,z as w,C as c,y as i,I as g,x as I,J as N,K as R,L as u,G as F,c as U,o as T,M as q,N as O,O as J,t as Q,P as W,Q as X}from"./entry.iaiyWZvb.js";import{_ as j}from"./_plugin-vue_export-helper.x3n3nnut.js";import{P as Y,u as Z}from"./PlanningPoker.3sqfMDzM.js";const ee=b({__name:"VotingOptions",props:{modelValue:{},modelModifiers:{}},emits:["update:modelValue"],setup(l){const _=z(l,"modelValue");return(a,o)=>{const r=n("v-radio"),s=n("v-col"),v=n("v-row"),d=n("v-radio-group");return m(),f(d,{modelValue:_.value,"onUpdate:modelValue":o[0]||(o[0]=y=>_.value=y),inline:"","hide-details":""},{default:t(()=>[e(v,{"no-gutters":""},{default:t(()=>[e(s,null,{default:t(()=>[e(r,{label:"N/A",value:"N/A"})]),_:1}),e(s,null,{default:t(()=>[e(r,{label:"1",value:"1"})]),_:1}),e(s,null,{default:t(()=>[e(r,{label:"2",value:"2"})]),_:1}),e(s,null,{default:t(()=>[e(r,{label:"3",value:"3"})]),_:1})]),_:1}),e(v,{"no-gutters":""},{default:t(()=>[e(s,null,{default:t(()=>[e(r,{label:"5",value:"5"})]),_:1}),e(s,null,{default:t(()=>[e(r,{label:"8",value:"8"})]),_:1}),e(s,null,{default:t(()=>[e(r,{label:"13",value:"13"})]),_:1}),e(s,null,{default:t(()=>[e(r,{label:"?",value:"?"})]),_:1})]),_:1})]),_:1},8,["modelValue"])}}}),te=i("p",null,[i("strong",null,"Effort"),c(),i("em",{class:"text-caption"},"How much overall work is there to do? Are we modifying a line, a method, a class?")],-1),oe=i("p",{class:"mt-2"},[i("strong",null,"Complexity"),c(),i("em",{class:"text-caption"},"How complicated are the changes? Are we implementing understood algorithms? Are we integrating a brand new library?")],-1),le=i("p",{class:"mt-2"},[i("strong",null,"Unknowns"),c(),i("em",{class:"text-caption"},"What do we not know? Are we concerned about unknown unknowns? Do we have an implementation plan?")],-1),ne=i("p",{class:"text-caption"},"Story Points",-1),ae=b({__name:"Voting",props:{player:{type:Object,required:!0},votes:{type:Object,required:!1}},setup(l){return(_,a)=>{const o=n("v-card-title"),r=n("v-card-text"),s=n("v-col"),v=n("v-row"),d=ee,y=n("v-card");return m(),f(y,{variant:"tonal"},{default:t(()=>[e(v,null,{default:t(()=>[e(s,{cols:"2"},{default:t(()=>[e(o,null,{default:t(()=>[c(w(l.player.name),1)]),_:1}),l.player.config.showDebug?(m(),f(r,{key:0},{default:t(()=>[i("pre",null,w(l.votes),1)]),_:1})):g("",!0)]),_:1}),e(s,null,{default:t(()=>[e(v,{"no-gutters":""},{default:t(()=>[e(s,null,{default:t(()=>[e(o,null,{default:t(()=>[c("Round 1")]),_:1})]),_:1})]),_:1}),e(v,{"no-gutters":""},{default:t(()=>[e(s,null,{default:t(()=>[e(r,null,{default:t(()=>[te,e(d,{modelValue:l.votes[1].e,"onUpdate:modelValue":a[0]||(a[0]=h=>l.votes[1].e=h)},null,8,["modelValue"]),oe,e(d,{modelValue:l.votes[1].c,"onUpdate:modelValue":a[1]||(a[1]=h=>l.votes[1].c=h)},null,8,["modelValue"]),le,e(d,{modelValue:l.votes[1].u,"onUpdate:modelValue":a[2]||(a[2]=h=>l.votes[1].u=h)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),e(s,{cols:"auto"},{default:t(()=>[e(y,{theme:"light",class:"fill-height"},{default:t(()=>[c(" ")]),_:1})]),_:1}),e(s,null,{default:t(()=>[e(v,{"no-gutters":""},{default:t(()=>[e(s,null,{default:t(()=>[e(o,null,{default:t(()=>[c("Round 2")]),_:1})]),_:1})]),_:1}),e(v,{"no-gutters":""},{default:t(()=>[e(s,null,{default:t(()=>[e(r,null,{default:t(()=>[ne,e(d,{modelValue:l.votes[2].sp,"onUpdate:modelValue":a[3]||(a[3]=h=>l.votes[2].sp=h)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})}}}),se=i("em",null,"Observing",-1),ue=b({__name:"Observing",props:{player:{type:Object,required:!0}},setup(l){return(_,a)=>{const o=n("v-card-title"),r=n("v-card-text"),s=n("v-col"),v=n("v-row"),d=n("v-card");return m(),f(d,{variant:"tonal"},{default:t(()=>[e(v,null,{default:t(()=>[e(s,{cols:"2"},{default:t(()=>[e(o,null,{default:t(()=>[c(w(l.player.name),1)]),_:1}),e(r,null,{default:t(()=>[se]),_:1})]),_:1}),e(s,null,{default:t(()=>[e(v,{"no-gutters":""},{default:t(()=>[e(s,null,{default:t(()=>[e(o,null,{default:t(()=>[c("Round 1")]),_:1})]),_:1})]),_:1})]),_:1}),e(s,{cols:"auto"},{default:t(()=>[e(d,{theme:"light",class:"fill-height"},{default:t(()=>[c(" ")]),_:1})]),_:1}),e(s,null,{default:t(()=>[e(v,{"no-gutters":""},{default:t(()=>[e(s,null,{default:t(()=>[e(o,null,{default:t(()=>[c("Round 2")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})}}}),re={key:0},de={key:1},ce={key:2},ie=b({__name:"VoteValue",props:{vote:{required:!0},showVotes:{type:Boolean,required:!1,default(){return!1}}},setup(l){return(_,a)=>{const o=n("v-icon"),r=n("v-progress-circular");return m(),I("span",null,[l.showVotes===!0&&l.vote!==null?(m(),I("span",re,w(l.vote),1)):g("",!0),l.showVotes===!1&&l.vote!==null?(m(),I("span",de,[e(o,{icon:"mdi-check",color:"success"})])):g("",!0),l.vote===null?(m(),I("span",ce,[e(r,{size:14,width:1,indeterminate:""})])):g("",!0)])}}}),_e=i("em",null,"Observing",-1),me={class:"mt-4"},fe={class:"mt-4"},ve=b({__name:"OtherPlayer",props:{player:{type:Object,required:!0},otherPlayer:{type:Object,required:!0},votes:{type:Object,required:!1,default(){return{1:{e:null,c:null,u:null},2:{sp:null}}}},showVotes:{type:Boolean,required:!1,default(){return!1}}},setup(l){return(_,a)=>{const o=n("v-card-title"),r=n("v-card-text"),s=n("v-col"),v=ie,d=n("v-card"),y=n("v-row");return m(),f(d,null,{default:t(()=>[e(y,null,{default:t(()=>[e(s,{cols:l.otherPlayer.config.role==="voting"?2:12},{default:t(()=>[e(o,null,{default:t(()=>[c(w(l.otherPlayer.name),1)]),_:1}),l.otherPlayer.config.role==="observing"?(m(),f(r,{key:0},{default:t(()=>[_e]),_:1})):g("",!0),l.player.config.showDebug?(m(),f(r,{key:1},{default:t(()=>[i("pre",null,w(l.votes),1)]),_:1})):g("",!0)]),_:1},8,["cols"]),l.otherPlayer.config.role==="voting"?(m(),f(s,{key:0},{default:t(()=>[e(r,null,{default:t(()=>[i("p",null,[c("Effort: "),e(v,{vote:l.votes[1].e,"show-votes":l.showVotes},null,8,["vote","show-votes"])]),i("p",me,[c("Complexity: "),e(v,{vote:l.votes[1].c,"show-votes":l.showVotes},null,8,["vote","show-votes"])]),i("p",fe,[c("Unknowns: "),e(v,{vote:l.votes[1].u,"show-votes":l.showVotes},null,8,["vote","show-votes"])])]),_:1})]),_:1})):g("",!0),l.otherPlayer.config.role==="voting"?(m(),f(s,{key:1,cols:"auto"},{default:t(()=>[e(d,{theme:"light",class:"fill-height"},{default:t(()=>[c(" ")]),_:1})]),_:1})):g("",!0),l.otherPlayer.config.role==="voting"?(m(),f(s,{key:2},{default:t(()=>[e(r,null,{default:t(()=>[i("p",null,[c("Story Points: "),e(v,{vote:l.votes[2].sp,"show-votes":l.showVotes},null,8,["vote","show-votes"])])]),_:1})]),_:1})):g("",!0)]),_:1})]),_:1})}}}),pe={},ge=i("p",null,"Loading room",-1);function he(l,_){const a=n("v-progress-circular"),o=n("v-card-text"),r=n("v-card"),s=n("v-dialog");return m(),f(s,{persistent:"","no-click-animation":"","close-on-back":!1,width:"auto"},{default:t(()=>[e(r,null,{default:t(()=>[e(o,{class:"text-center"},{default:t(()=>[ge,e(a,{indeterminate:"",class:"mt-4"})]),_:1})]),_:1})]),_:1})}const ye=j(pe,[["render",he]]),we={},Ve=i("p",null,"Disconnected",-1);function be(l,_){const a=n("v-card-text"),o=n("v-card"),r=n("v-dialog");return m(),f(r,{persistent:"","no-click-animation":"","close-on-back":!1,width:"auto"},{default:t(()=>[e(o,null,{default:t(()=>[e(a,{class:"text-center"},{default:t(()=>[Ve]),_:1})]),_:1})]),_:1})}const xe=j(we,[["render",be]]),ke=b({__name:"PlayerInfo",emits:["updated"],setup(l,{emit:_}){const a=N(),o=R({name:""}),r=_;function s(){a.setName(o.name)!==!1&&r("updated")}return(v,d)=>{const y=n("v-card-title"),h=n("v-text-field"),C=n("v-card-text"),P=n("v-spacer"),S=n("v-btn"),V=n("v-card-actions"),D=n("v-card"),x=n("v-dialog");return m(),f(x,{persistent:"","close-on-back":!1,"max-height":"80%","max-width":"80%",width:"300px"},{default:t(()=>[e(D,null,{default:t(()=>[e(y,null,{default:t(()=>[c("Player details")]),_:1}),e(C,{class:"text-center"},{default:t(()=>[e(h,{modelValue:u(o).name,"onUpdate:modelValue":d[0]||(d[0]=$=>u(o).name=$),label:"Name*",autofocus:"",required:"",onKeyup:F(s,["enter"])},null,8,["modelValue"])]),_:1}),e(V,null,{default:t(()=>[e(P),e(S,{color:"primary",onClick:s},{default:t(()=>[c("Save")]),_:1})]),_:1})]),_:1})]),_:1})}}});class Se{constructor(_){k(this,"userStore",null);k(this,"gameStore",null);k(this,"roomId","");k(this,"game",null);k(this,"data",R({dialogs:{playerInfo:!1},player:{name:"",id:"",config:{role:"voting",showDebug:!1}},host:!1,game:null,loading:!0,disconnected:!1}));this.roomId=_,this.game=new Y(this.roomId),this.gameStore=Z(),this.userStore=N(),this.data.host=U(()=>this.gameStore.host),this.data.game=this.gameStore,this.data.player.name=U(()=>this.userStore.name),this.data.player.id=U(()=>this.userStore.id),this.data.player.config.role=U({get:()=>this.userStore.config.role,set:a=>{this.userStore.setRole(a)}}),this.data.player.config.showDebug=U({get:()=>this.userStore.config.showDebug,set:a=>{this.userStore.setDebug(a)}}),T(this.mounted.bind(this))}mounted(){this.start()}async start(){if(this.data.player.name===""){this.data.dialogs.playerInfo=!0;return}try{await this.game.joinRoom(),this.game.once("receive-state",()=>{q(()=>{this.data.loading=!1})}),this.game.on("room-closed",()=>{q(()=>{this.data.disconnected=!0})})}catch{await this.game.createRoom(),this.gameStore.setHost(!0),this.game.reset(),this.data.loading=!1,O(()=>this.gameStore.showVotes,a=>{this.game.queueSync()})}O(()=>this.gameStore.votes[this.gameStore.playerId],(_,a)=>{this.game.sendVotes(_)},{deep:!0}),O(this.userStore.config,()=>{this.game.sendInfo()},{deep:!0})}playerInfoUpdated(){this.data.dialogs.playerInfo=!1,this.start()}clearVotes(){this.game.clearVotes()}}const $e=i("p",null,"Votes",-1),Ue=i("p",null,"Game",-1),Ie=i("p",{class:"mt-4"},"Dialogs",-1),Pe=i("p",{class:"mt-4"},"Player",-1),Ne=b({__name:"[roomId]",setup(l){const{roomId:_}=J().params;Q({title:`Room ${_}`});const a=new Se(_),o=a.data,r=a.playerInfoUpdated.bind(a),s=a.clearVotes.bind(a);return(v,d)=>{const y=ae,h=ue,C=ve,P=n("v-col"),S=n("v-card-title"),V=n("v-btn"),D=n("v-btn-toggle"),x=n("v-card-text"),$=n("v-card"),A=n("v-switch"),B=n("v-row"),H=ye,M=xe,E=ke,G=n("v-container");return m(),f(G,{fluid:""},{default:t(()=>[u(o).loading===!1&&u(o).disconnected===!1?(m(),f(B,{key:0},{default:t(()=>[e(P,null,{default:t(()=>[u(o).player.config.role==="voting"?(m(),f(y,{key:0,player:u(o).player,votes:u(o).game.votes[u(o).game.playerId]},null,8,["player","votes"])):g("",!0),u(o).player.config.role==="observing"?(m(),f(h,{key:1,player:u(o).player},null,8,["player"])):g("",!0),(m(!0),I(X,null,W(u(o).game.players,p=>(m(),f(C,{player:u(o).player,"other-player":p,votes:u(o).game.votes[p.id],"show-votes":u(o).game.showVotes,class:"mt-4"},null,8,["player","other-player","votes","show-votes"]))),256))]),_:1}),e(P,{cols:"auto"},{default:t(()=>[u(o).host?(m(),f($,{key:0,class:"mb-4"},{default:t(()=>[e(S,null,{default:t(()=>[c("Controls")]),_:1}),e(x,null,{default:t(()=>[$e,e(D,{modelValue:u(o).game.showVotes,"onUpdate:modelValue":d[0]||(d[0]=p=>u(o).game.showVotes=p),class:"mt-2",block:"",divided:"",mandatory:"",variant:"outlined"},{default:t(()=>[e(V,{value:!1},{default:t(()=>[c("Hide")]),_:1}),e(V,{value:!0},{default:t(()=>[c("Show")]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(x,null,{default:t(()=>[e(V,{block:"",color:"blue-grey",onClick:u(s)},{default:t(()=>[c("Clear Votes")]),_:1},8,["onClick"])]),_:1})]),_:1})):g("",!0),e($,null,{default:t(()=>[e(S,null,{default:t(()=>[c("Config")]),_:1}),e(x,null,{default:t(()=>[e(D,{modelValue:u(o).player.config.role,"onUpdate:modelValue":d[1]||(d[1]=p=>u(o).player.config.role=p),block:"",divided:"",mandatory:"",variant:"outlined"},{default:t(()=>[e(V,{value:"voting"},{default:t(()=>[c("Vote")]),_:1}),e(V,{value:"observing"},{default:t(()=>[c("Observe")]),_:1})]),_:1},8,["modelValue"]),e(A,{modelValue:u(o).player.config.showDebug,"onUpdate:modelValue":d[2]||(d[2]=p=>u(o).player.config.showDebug=p),label:"Show debug","hide-details":""},null,8,["modelValue"])]),_:1})]),_:1}),u(o).player.config.showDebug?(m(),f($,{key:1,class:"mt-4"},{default:t(()=>[e(S,null,{default:t(()=>[c("Debug")]),_:1}),e(x,null,{default:t(()=>[Ue,i("pre",null,w(u(o).game),1),Ie,i("pre",null,w(u(o).dialogs),1),Pe,i("pre",null,w(u(o).player),1)]),_:1})]),_:1})):g("",!0)]),_:1})]),_:1})):g("",!0),e(H,{modelValue:u(o).loading,"onUpdate:modelValue":d[3]||(d[3]=p=>u(o).loading=p)},null,8,["modelValue"]),e(M,{modelValue:u(o).disconnected,"onUpdate:modelValue":d[4]||(d[4]=p=>u(o).disconnected=p)},null,8,["modelValue"]),e(E,{modelValue:u(o).dialogs.playerInfo,"onUpdate:modelValue":d[5]||(d[5]=p=>u(o).dialogs.playerInfo=p),onUpdated:u(r)},null,8,["modelValue","onUpdated"])]),_:1})}}});export{Ne as default};
